!function(){function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}window.ChatFunnels=function(t){var n,i,r,o=!1,a=t.packet_code,s=t.app_url,c=t.service_address;"cb6dbb20bfbeee14b104c353779772ef78d549b2"===a&&(s="https://beta.chatfunnels.com/chat-client/",c="beta.chatfunnels.com/api/chat-service/a");var l,d,u=t.debug||!1,p=window.document.title,m=t.hideMode||!1,f=null,h=!1,g=0,w={},v={},b={},y=window.crypto||window.msCrypto,_={first_name:"",last_name:"",email:"",unique_id:null},x={type:"page_change",url:"",page_title:"",plid:"",referrer:""},A={},I=null,S=t.mode||"normal",k=t.chatInitReady||function(){},O=t.bot_id,C=t.parentElement,j=t.chatCompletelyReady,D=t.preventCriteriaPrompts||!1,E=t.supportBot||!1,M=(d=(l=function e(){return e.get.apply(e,arguments)}).utils={isArray:Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},isPlainObject:function(e){return!!e&&"[object Object]"===Object.prototype.toString.call(e)},toArray:function(e){return Array.prototype.slice.call(e)},getKeys:Object.keys||function(e){var t=[],n="";for(n in e)e.hasOwnProperty(n)&&t.push(n);return t},encode:function(e){return String(e).replace(/[,;"\\=\s%]/g,(function(e){return encodeURIComponent(e)}))},decode:function(e){return decodeURIComponent(e)},retrieve:function(e,t){return null==e?t:e}},l.defaults={},l.expiresMultiplier=86400,l.set=function(t,n,i){if(d.isPlainObject(t))for(var r in t)t.hasOwnProperty(r)&&this.set(r,t[r],n);else{var o=void 0!==(i=d.isPlainObject(i)?i:{expires:i}).expires?i.expires:this.defaults.expires||"",a=e(o);"string"===a&&""!==o?o=new Date(o):"number"===a&&(o=new Date(+new Date+1e3*this.expiresMultiplier*o)),""!==o&&"toUTCString"in o&&(o=";expires="+o.toUTCString());var s=i.path||this.defaults.path;s=s?";path="+s:"";var c=i.domain||this.defaults.domain;c=c?";domain="+c:"";var l=i.secure||this.defaults.secure?";secure":"";!1===i.secure&&(l="");var u=i.sameSite||this.defaults.sameSite;u=u?";SameSite="+u:"",null===i.sameSite&&(u=""),document.cookie=d.encode(t)+"="+d.encode(n)+o+s+c+l+u}return this},l.setDefault=function(e,t,n){if(d.isPlainObject(e)){for(var i in e)void 0===this.get(i)&&this.set(i,e[i],t);return l}if(void 0===this.get(e))return this.set.apply(this,arguments)},l.remove=function(e){for(var t=0,n=(e=d.isArray(e)?e:d.toArray(arguments)).length;t<n;t++)this.set(e[t],"",-1);return this},l.removeSpecific=function(e,t){if(!t)return this.remove(e);e=d.isArray(e)?e:[e],t.expires=-1;for(var n=0,i=e.length;n<i;n++)this.set(e[n],"",t);return this},l.empty=function(){return this.remove(d.getKeys(this.all()))},l.get=function(e,t){var n=this.all();if(d.isArray(e)){for(var i={},r=0,o=e.length;r<o;r++){var a=e[r];i[a]=d.retrieve(n[a],t)}return i}return d.retrieve(n[e],t)},l.all=function(){if(""===document.cookie)return{};for(var e=document.cookie.split("; "),t={},n=0,i=e.length;n<i;n++){var r=e[n].split("="),o=d.decode(r.shift()),a=d.decode(r.join("="));t[o]=a}return t},l.enabled=function(){if(navigator.cookieEnabled)return!0;var e="_"===l.set("_","_").get("_");return l.remove("_"),e},l);function T(){var e=window.location.host,t=e.split(".");return t.length<=1?e:t.length>2?"."+t.slice(1,t.length).join("."):"."+t.join(".")}function V(){var e="cf_"+a;return!window.document.getElementById(e)&&("content"===S||"content-with-header"===S?function(){var e="cf_"+a;return i=window.document.createElement("iframe"),r=window.document.createElement("div"),i.setAttribute("id",e),i.setAttribute("style","\n      background-color: transparent;\n      border: none;\n      "),i.setAttribute("frameborder","0"),i.setAttribute("marginheight","0"),i.setAttribute("marginwidth","0"),i.setAttribute("scrolling","auto"),i.setAttribute("src",s),r.appendChild(i),C.appendChild(r),n=i.contentWindow,k&&k(i),!0}():(i=window.document.createElement("iframe"),r=window.document.createElement("div"),i.setAttribute("id",e),i.setAttribute("style","\n      height: 1px;\n      width: 1px;\n      display: none;\n      position: fixed;\n      right: 0px;\n      bottom: 0px;\n      background-color: transparent;\n      z-index: 1000;\n      border: none;\n      max-height: 700px;\n      max-width: 415px;\n      color-scheme: none;\n      "),i.setAttribute("frameborder","0"),i.setAttribute("marginheight","0"),i.setAttribute("marginwidth","0"),i.setAttribute("scrolling","auto"),i.setAttribute("src",s),r.setAttribute("style","\n      position: absolute;\n      z-index: 10000000;\n      "),r.appendChild(i),window.document.body.appendChild(r),n=i.contentWindow,k&&k(window.ChatFunnels,i),!0))}if(!t.disabled&&!V())return;function H(e,t){t||(t={});var i=function(){var e=window.document.visibilityState,t=window.document.hasFocus(),n="";try{n=Intl.DateTimeFormat().resolvedOptions().timeZone}catch(e){}n||(n="");return{vs:e,fs:t,title:window.document.title,sy:window.scrollY,ms:g,tz:n,loc:window.location.href}}(),r={type:"cf_events",attributes:{kind:e,plid:f,url:i.loc,referrer:U(),title:i.title,tz:i.tz,props:t}};n.postMessage(r,"*")}function L(){window.addEventListener("hashchange",(function(){x.url=window.location.href,x.referrer=U(),x.page_title=window.document.title,x.plid=f,n.postMessage(x,"*")}))}function P(){var e=null;window.addEventListener("scroll",(function(t){var n=function(){var e=document.body,t=document.documentElement,n=Math.max(e.scrollHeight,e.offsetHeight,t.clientHeight,t.scrollHeight,t.offsetHeight),i=window.innerHeight,r=n-i;r<=0&&(r=1e-4);var o=window.scrollY;if(!o)return 0;var a=o/r*100;if(a=Math.floor(a),Number.isNaN(a))return 0;return a}(),i=!1;n>g+6&&(i=!0),n>g&&(g=n),!h||i?H("scroll",{sp:n}):(e&&(clearTimeout(e),e=null),e=setTimeout((function(){H("scroll",{sp:n})}),400)),h=!0}))}function F(e){var t=new Uint8Array(e);y.getRandomValues(t);for(var n=[],i=0;i<t.length;i++){var r=t[i].toString(20);r.length<2&&(r="0"+r),n.push(r)}return n.join("")}function z(){dataLayer.push(arguments)}function U(){var e=sessionStorage.getItem("referrer");return e||("Direct"==e?"":(document.referrer?sessionStorage.setItem("referrer",document.referrer):sessionStorage.setItem("referrer","Direct"),document.referrer))}function W(){var e=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,t=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,i={type:"id",id:function(){var e=a.slice(0,16)+"_cfid",t=M.get("_cfid"),n=M.get(e);if(!n){if(t)return t;var i=function(e){var t=new URLSearchParams(window.location.search).get("cfid");if(t){var n=t.split("_");if(2===n.length&&e===n[1])return n[0]}return null}(a);n=i||F(64),M.set(e,n,{sameSite:"lax",path:"/",domain:T(),expires:730,secure:!0});var r=M.get(e);r!==n&&(M.set(e,n,{sameSite:"lax",path:"/",expires:730,secure:!0}),r=M.get(e))}return n}(),packet_code:a,chatServiceUrl:c,page_load_id:f,page_url:window.location.href,referrer:U(),page_title:window.document.title,debug:u,hide_mode:m,mode:S,auto_load_bot_id:O,preventCriteriaPrompts:D,supportBot:E,screen:{x:e,y:t},identity:_,meta:{}};if(M.get("hubspotutk")){var r=M.get("hubspotutk");i.meta.hutk=r}n.postMessage(i,"*")}function B(e){var t;o=!0,t=a.slice(0,16)+"_cf_blocked",M.get(t)||(f=F(8),W(),L(),P(),last_url=window.location.pathname,j&&j(window.ChatFunnels,i))}function R(){var e=location.hash;if(e&&(e=e.substring(1),w.fragments&&w.fragments[e])){var t=w.fragments[e];n.postMessage({type:"bot_trigger_id",botID:t},"*")}}window.dataLayer=window.dataLayer||[],window.addEventListener("popstate",(function(){R()}),!1);var N,q={Vars:{OriginalTitle:p,Interval:null},On:function(e,t){var n=this;n.Vars.Interval=setInterval((function(){window.document.title=n.Vars.OriginalTitle===window.document.title?e:n.Vars.OriginalTitle}),t||500)},Off:function(){clearInterval(this.Vars.Interval),this.Vars.Interval=null,document.title=this.Vars.OriginalTitle}};if(void 0!==document.hidden?N="visibilitychange":void 0!==document.msHidden?N="msvisibilitychange":void 0!==document.webkitHidden&&(N="webkitvisibilitychange"),document.addEventListener(N,(function(){q.Off()}),!1),window.visualViewport){var G=function(){var e={height:window.visualViewport.height,offsetTop:window.visualViewport.offsetTop};e.height===A.height&&e.offsetTop===A.offsetTop||(A=e,n&&n.postMessage({type:"visualviewport_size",height:window.visualViewport.height,offsetTop:window.visualViewport.offsetTop},"*"))};window.visualViewport.addEventListener("resize",G),window.visualViewport.addEventListener("scroll",(function(){I||(I=setTimeout((function(){I=null,G()}),250))})),setInterval(G,1e4)}return window.addEventListener("message",(function(e){if(e.source===n){var r,o,s,c,l=e.data;"resize"===l.command&&"content"!==S&&"content-with-header"!==S?(i.style.width=l.params.x,i.style.height=l.params.y,i.style.minHeight=l.params.minHeight,i.style.maxWidth=l.params.maxWidth,i.style.maxHeight=l.params.maxHeight):"block_participant"===l.command?(r=l.params.expired_timestamp,o=new Date(r),s=parseInt((o-new Date)/864e5),c=a.slice(0,16)+"_cf_blocked",M.set(c,!0,{sameSite:"lax",path:"/",expires:s,secure:!0})):"hide"===l.command?i.style.display="none":"show"===l.command?i.style.display="block":"appLoaded"===l.command?t.appLoaded&&t.appLoaded(window.ChatFunnels,i):"activate"===l.command?B(l.params):"set_triggers"===l.command?function(e){w.fragments=e.bot_fragments,w.selectors=e.bot_selectors;var t=function(e){if(!w.selectors.hasOwnProperty(e))return"continue";var t=w.selectors[e];!function(e,t){for(var n=0;n<e.length;n++)e[n].addEventListener("click",t)}(document.querySelectorAll(e),(function(){n.postMessage({type:"bot_trigger_id",botID:t},"*")}))};for(var i in w.selectors)t(i);R()}(l.params):"new_message"===l.command?window.document.hidden&&(n.postMessage({type:"play_sound"},"*"),q.Vars.Interval||q.On("New Message!")):"ga_setup"===l.command?(function(e){if(e.trackingId){var t=window[window.GoogleAnalyticsObject];t?t("create",e.trackingId,"auto","ChatFunnels"):console.error("Google analytics object not found, could not setup"),v=e}}(l.params),function(e){e.measurementID&&(console.log("setting up GA4"),z("js",new Date),z("config",e.measurementID,{send_page_view:!1}),b=e)}(l.params)):"ga"===l.command&&(function(e){if(v.trackingId){var t=window[window.GoogleAnalyticsObject];t&&t("ChatFunnels.send","event","ChatFunnels",e.action,e.label)}}(l.params),function(e){b.measurementID&&z("event","Signals",{event_action:e.action,event_label:e.label})}(l.params))}})),{identify:function(e){_.first_name=e.first_name,_.last_name=e.last_name,_.email=e.email,_.company_name=e.company_name,_.phone=e.phone,_.unique_id=e.unique_id,o&&W()},_internal:{hard_enable:V,loadBot:function(e){n.postMessage({type:"bot_trigger_id",botID:e},"*")},previewBot:function(e){n.postMessage({type:"bot_trigger_id",botID:e,preview:!0})},closeBots:function(){i.style.display="none",n.postMessage({type:"open_state",state:!1},"*")},hard_disable:function(){r.parentNode.removeChild(r),r=null,i=null,n=null},createChatWithUserId:function(e){n.postMessage({type:"conversation_by_user_id",userID:e},"*")}}}}(cf_chat_loader())}();
//# sourceMappingURL=chat-loader.js.map
